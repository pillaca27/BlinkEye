<?xml version="1.0" encoding="UTF-8"?>
<!-- * * @author : desarrollo * @powerbuilder : contabilidad.AcSucursalgrupo -->
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<hibernate-mapping>

	<sql-query name="pruebas.listarRequerimientos">
		select
		Requerimiento as "requerimiento", 
		a.CompanyOwner as "companyowner",
		rtrim(d.description) as "companiaNombre",
		rtrim(b.NombreCompleto) as "solicitanteNombre",
		rtrim(c.Descripcion) as "puestoNombre",
		CONVERT(varchar,a.FechaSolicitud,103) as "fechaSolicitud"
		from hr_requerimiento a
		left join PersonaMast b on a.EmpleadoSolicitante = b.Persona
		left join HR_PuestoEmpresa c on c.CodigoPuesto = a.CodigoPuesto
		left join companyowner d on d.companyowner = a.CompanyOwner
		where Requerimiento = isnull(:p_requerimiento, Requerimiento)
	</sql-query>
	
	<sql-query name="pruebas.listarEvaluaciones">
		sp_hr_listarevaluaciones :p_compania, :p_secuencia
	</sql-query>
	
	<sql-query name="pruebas.anularRequerimiento">
		update hr_requerimiento set estado = 'N' WHERE COMPANYOWNER = :p_compania AND REQUERIMIENTO = :p_requerimiento
	</sql-query>
	
	<sql-query name="pruebas.listarPersonasPaginacion">
		select
		Persona AS "personaCodigo", 
		NombreCompleto as "personaNombreCompleto"
		from personamast
		where 
		(Busqueda like '%' + ISNULL(:p_nombre, '') + '%')
	</sql-query>
	
	<sql-query name="pruebas.contarPersonasPaginacion">
		select
		count(1)
		from personamast
		where 
		(Busqueda like '%' + ISNULL(:p_nombre, '') + '%')
	</sql-query>
	
	<sql-query name="pruebas.listarusuarioexportar">
		select
		rtrim(Usuario) "usuario",
		rtrim(Nombre) "nombre",
		rtrim(tp.Descripcion) "tipoPlanillaNombre",
		rtrim(co.companyowner) "compania",
		rtrim(co.description) "companiaNombre"
		from
		usuario u join
		empleadomast e on codigousuario = usuario
		JOIN PR_TipoPlanilla tp on tp.TipoPlanilla = e.TipoPlanilla
		JOIN companyowner co on co.companyowner = e.CompaniaSocio
		where
		e.CentroCostos = ISNULL(:p_centrocosto, e.CentroCostos)
		and e.estado = 'A' 
	</sql-query>

</hibernate-mapping>
